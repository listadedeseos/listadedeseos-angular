<main class="p-2">

    @if(isLogged){

    <header class="flex flex-col gap-2 mb-2">

        <button class="ml-auto bg-gray-800 border border-gray-600 p-2 rounded col-span-3 md:col-span-6"
            (click)="toggleModalWishList()">Añadir nueva lista</button>

        <section class="grid grid-cols-3 md:grid-cols-6 gap-2">
            @for(item of allWishList; track $index){
            <a [routerLink]="['/list', username, item.name]" class="bg-gray-700 p-2 rounded">
                {{item.name??'Principal'}}
            </a>
            }
        </section>

    </header>

    <section class="flex justify-between items-center mb-2">
        <h1>{{wishlist.name}} <a class="underline" [href]="'https://'+getwishListUrl()">{{getwishListUrl()}}</a> </h1>

        <button class="bg-gray-800 border border-gray-700 p-2 rounded" (click)="toggleModalProduct()">Añadir
            nuevo producto</button>
    </section>
    }

    <section class="grid gap-2 grid-cols-3 md:grid-cols-6">

        @for(item of wishlist.products; track $index){
        <div class="bg-gray-800 text-white border border-gray-700 rounded shadow p-2 grid gap-1 grid-cols-1">

            <a [href]="item.url_product" target="_blank" class="flex justify-center">
                <img class="rounded" [src]="item.url_preview" loading="lazy" alt="product image">
            </a>

            <a [href]="item.url_product">
                <h5 class="text-xl font-semibold tracking-tight text-white max-h-[3.5rem] overflow-hidden"
                    [title]="item.name">{{item.name}}</h5>
            </a>

            <div>{{item.price}}</div>

            <a [href]="item.url_product" target="_blank" class="
                bg-gray-700 font-medium rounded-lg text-center p-2 mt-auto
                flex flex-col align-center justify-center
                text-white text-xs
                hover:bg-blue-700 hover:text-white
            ">Comprar</a>

        </div>
        }

    </section>
</main>

@if(modalProductOpen && wishListId){
<app-product-form [wishListId]="wishListId" (closeFunction)="toggleModalProduct()"
    (acceptFunction)="productUpdate($event)"></app-product-form>
}

@if(modalWishListOpen && wishListId){
<app-wishlist-form [wishListId]="wishListId" (closeFunction)="toggleModalWishList()"
    (acceptFunction)="wishlistUpdate($event)"></app-wishlist-form>
}